"use strict";(self.webpackChunkalphaFront2=self.webpackChunkalphaFront2||[]).push([[392],{7392:(U,m,c)=>{c.r(m),c.d(m,{LoanBookUploadComponent:()=>D});var d=c(4341),p=c(177),_=c(3152),h=c(5312),e=c(3953),x=c(3366),C=c(1626);let b=(()=>{class a{apiService;http;constructor(t,o){this.apiService=t,this.http=o}uploadFile(t){const o=new FormData;return o.append("file",t),this.http.post(`${h.c.apiBaseUrl}/loan-book/upload`,o)}importLoans(t){return this.apiService.post("/loan-book/import",t)}getUploadStats(){return this.apiService.get("/loan-book/stats")}validateLoan(t){return this.apiService.post("/loan-book/validate",t)}exportToCSV(t,o){const s=t.map(i=>[i.rowNumber,i.customerId,i.customerName,i.phoneNumber,i.productCode,i.principal,i.interestRate,i.term,i.status,i.isValid?"Yes":"No",i.errorMessage||""]),u=[["Row","Customer ID","Customer Name","Phone Number","Product Code","Principal","Interest Rate","Term","Status","Valid","Error Message"].join(","),...s.map(i=>i.map(f=>`"${f}"`).join(","))].join("\n"),g=new Blob([u],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(g),l.download=`${o}_${this.getFormattedDate()}.csv`,l.click()}getFormattedDate(){return(new Date).toISOString().split("T")[0].replace(/-/g,"")}formatCurrency(t){return new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(t)}getStatusColor(t){return{ACTIVE:"success",CLOSED:"secondary",DEFAULTED:"danger",WRITTEN_OFF:"warning"}[t]||"secondary"}getValidationIcon(t){return t?"check_circle":"error"}getValidationColor(t){return t?"success":"danger"}static \u0275fac=function(o){return new(o||a)(e.KVO(x.G),e.KVO(C.Qq))};static \u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();function v(a,r){if(1&a&&(e.j41(0,"div",18)(1,"i",3),e.EFF(2,"error"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&a){const t=e.XpG();e.R7$(4),e.JRh(t.errorMessage)}}function P(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",26)(1,"i",3),e.EFF(2,"cloud_upload"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"Drag & Drop your Excel file here"),e.k0s(),e.j41(5,"p"),e.EFF(6,"or"),e.k0s(),e.j41(7,"label",27)(8,"i",3),e.EFF(9,"folder_open"),e.k0s(),e.EFF(10," Browse Files "),e.k0s(),e.j41(11,"input",28),e.bIt("change",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onFileSelected(n))}),e.k0s(),e.j41(12,"p",29),e.EFF(13,"Supported: .xlsx, .xls, .csv (Max 10MB)"),e.k0s()()}}function k(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",30)(1,"i",31),e.EFF(2,"description"),e.k0s(),e.j41(3,"div",32)(4,"h3"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s()(),e.j41(8,"button",33),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.selectedFile=null)}),e.j41(9,"i",3),e.EFF(10,"close"),e.k0s()()()}if(2&a){const t=e.XpG(2);e.R7$(5),e.JRh(t.selectedFile.name||""),e.R7$(2),e.JRh(t.getFileSizeMB())}}function M(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",34)(1,"button",35),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.selectedFile=null)}),e.EFF(2," Cancel "),e.k0s(),e.j41(3,"button",6),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.uploadFile())}),e.j41(4,"i",3),e.EFF(5,"upload"),e.k0s(),e.EFF(6," Upload & Validate "),e.k0s()()}}function O(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",19)(1,"div",20)(2,"div",21),e.bIt("drop",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onFileDrop(n))})("dragover",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.onDragOver(n))}),e.DNE(3,P,14,0,"div",22)(4,k,11,2,"div",23),e.k0s(),e.DNE(5,M,7,0,"div",24),e.j41(6,"div",25)(7,"h3")(8,"i",3),e.EFF(9,"info"),e.k0s(),e.EFF(10," Instructions "),e.k0s(),e.j41(11,"ol")(12,"li"),e.EFF(13,"Download the template using the button above"),e.k0s(),e.j41(14,"li"),e.EFF(15,"Fill in all required fields marked with (*)"),e.k0s(),e.j41(16,"li"),e.EFF(17,"Ensure Customer IDs and Product Codes exist in the system"),e.k0s(),e.j41(18,"li"),e.EFF(19,"Upload the completed Excel or CSV file"),e.k0s(),e.j41(20,"li"),e.EFF(21,"Review validation results"),e.k0s(),e.j41(22,"li"),e.EFF(23,"Import validated loans"),e.k0s()()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.AVh("has-file",t.selectedFile),e.R7$(),e.Y8G("ngIf",!t.selectedFile),e.R7$(),e.Y8G("ngIf",t.selectedFile),e.R7$(),e.Y8G("ngIf",t.selectedFile)}}function F(a,r){1&a&&e.nrm(0,"div",40)}function w(a,r){if(1&a&&(e.j41(0,"div",41)(1,"div",42),e.nrm(2,"div",43),e.k0s(),e.j41(3,"div",44),e.EFF(4),e.k0s()()),2&a){const t=e.XpG(2);e.R7$(2),e.xc7("width",t.uploadProgress,"%"),e.R7$(2),e.SpI("",t.uploadProgress,"%")}}function y(a,r){if(1&a&&(e.j41(0,"div",36)(1,"div",37),e.DNE(2,F,1,0,"div",38)(3,w,5,3,"div",39),e.j41(4,"h2"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s()()()),2&a){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",!t.uploading),e.R7$(),e.Y8G("ngIf",t.uploading),e.R7$(2),e.JRh(t.uploading?"Uploading & Validating...":"Validating Data..."),e.R7$(2),e.JRh(t.uploading?"Please wait while we upload and validate your loan data":"Please wait while we validate your loan data")}}function R(a,r){if(1&a&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"span",63)(5,"i",3),e.EFF(6),e.k0s(),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.k0s(),e.j41(12,"td"),e.EFF(13),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s(),e.j41(16,"td"),e.EFF(17),e.k0s(),e.j41(18,"td"),e.EFF(19),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td")(23,"span",63),e.EFF(24),e.k0s()(),e.j41(25,"td",64),e.EFF(26),e.k0s()()),2&a){const t=r.$implicit,o=e.XpG(2);e.AVh("valid-row",t.isValid)("invalid-row",!t.isValid),e.R7$(2),e.JRh(null==t?null:t.rowNumber),e.R7$(2),e.HbH(o.getValidationColor((null==t?null:t.isValid)||!1)),e.R7$(2),e.JRh(o.getValidationIcon((null==t?null:t.isValid)||!1)),e.R7$(),e.SpI(" ",null!=t&&t.isValid?"Valid":"Invalid"," "),e.R7$(2),e.JRh(null==t?null:t.customerId),e.R7$(2),e.JRh(null==t?null:t.customerName),e.R7$(2),e.JRh(null==t?null:t.phoneNumber),e.R7$(2),e.JRh(null==t?null:t.productCode),e.R7$(2),e.JRh(o.formatCurrency((null==t?null:t.principal)||0)),e.R7$(2),e.SpI("",null==t?null:t.interestRate,"%"),e.R7$(2),e.SpI("",null==t?null:t.term," months"),e.R7$(2),e.HbH(o.getStatusColor((null==t?null:t.status)||"")),e.R7$(),e.SpI(" ",null==t?null:t.status," "),e.R7$(2),e.JRh((null==t?null:t.errorMessage)||"-")}}function j(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",65)(1,"button",66),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.changePage(n.currentPage-1))}),e.j41(2,"i",3),e.EFF(3,"chevron_left"),e.k0s()(),e.j41(4,"span",67),e.EFF(5),e.k0s(),e.j41(6,"button",66),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.changePage(n.currentPage+1))}),e.j41(7,"i",3),e.EFF(8,"chevron_right"),e.k0s()()()}if(2&a){const t=e.XpG(2);e.R7$(),e.Y8G("disabled",1===t.currentPage),e.R7$(4),e.Lme("Page ",t.currentPage," of ",t.getTotalPages(),""),e.R7$(),e.Y8G("disabled",t.currentPage===t.getTotalPages())}}function E(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",45)(1,"div",46)(2,"div",47)(3,"i",3),e.EFF(4,"description"),e.k0s(),e.j41(5,"div",48)(6,"h3"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9,"Total Rows"),e.k0s()()(),e.j41(10,"div",49)(11,"i",3),e.EFF(12,"check_circle"),e.k0s(),e.j41(13,"div",48)(14,"h3"),e.EFF(15),e.k0s(),e.j41(16,"p"),e.EFF(17,"Valid Loans"),e.k0s()()(),e.j41(18,"div",50)(19,"i",3),e.EFF(20,"error"),e.k0s(),e.j41(21,"div",48)(22,"h3"),e.EFF(23),e.k0s(),e.j41(24,"p"),e.EFF(25,"Invalid Loans"),e.k0s()()()(),e.j41(26,"div",51)(27,"div",52)(28,"button",53),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return n.showValidOnly=!1,n.showInvalidOnly=!1,e.Njj(n.currentPage=1)}),e.EFF(29),e.k0s(),e.j41(30,"button",53),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return n.showValidOnly=!0,n.showInvalidOnly=!1,e.Njj(n.currentPage=1)}),e.EFF(31),e.k0s(),e.j41(32,"button",53),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return n.showInvalidOnly=!0,n.showValidOnly=!1,e.Njj(n.currentPage=1)}),e.EFF(33),e.k0s()(),e.j41(34,"div",54)(35,"i",3),e.EFF(36,"search"),e.k0s(),e.j41(37,"input",55),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.searchQuery,n)||(s.searchQuery=n),e.Njj(n)}),e.bIt("input",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.currentPage=1)}),e.k0s()(),e.j41(38,"button",56),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.exportResults())}),e.j41(39,"i",3),e.EFF(40,"download"),e.k0s(),e.EFF(41," Export Results "),e.k0s()(),e.j41(42,"div",57)(43,"table",58)(44,"thead")(45,"tr")(46,"th"),e.EFF(47,"Row"),e.k0s(),e.j41(48,"th"),e.EFF(49,"Status"),e.k0s(),e.j41(50,"th"),e.EFF(51,"Customer ID"),e.k0s(),e.j41(52,"th"),e.EFF(53,"Customer Name"),e.k0s(),e.j41(54,"th"),e.EFF(55,"Phone"),e.k0s(),e.j41(56,"th"),e.EFF(57,"Product"),e.k0s(),e.j41(58,"th"),e.EFF(59,"Principal"),e.k0s(),e.j41(60,"th"),e.EFF(61,"Rate"),e.k0s(),e.j41(62,"th"),e.EFF(63,"Term"),e.k0s(),e.j41(64,"th"),e.EFF(65,"Loan Status"),e.k0s(),e.j41(66,"th"),e.EFF(67,"Error Message"),e.k0s()()(),e.j41(68,"tbody"),e.DNE(69,R,27,20,"tr",59),e.k0s()()(),e.DNE(70,j,9,4,"div",60),e.j41(71,"div",61)(72,"button",35),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.reset())}),e.j41(73,"i",3),e.EFF(74,"close"),e.k0s(),e.EFF(75," Cancel "),e.k0s(),e.j41(76,"button",56),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.exportResults())}),e.j41(77,"i",3),e.EFF(78,"download"),e.k0s(),e.EFF(79," Export Results "),e.k0s(),e.j41(80,"button",62),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.importLoans())}),e.j41(81,"i",3),e.EFF(82,"import_export"),e.k0s(),e.EFF(83),e.k0s()()()}if(2&a){const t=e.XpG();e.R7$(7),e.JRh(t.uploadResult.totalRows),e.R7$(8),e.JRh(t.uploadResult.validRows),e.R7$(8),e.JRh(t.uploadResult.invalidRows),e.R7$(5),e.AVh("active",!t.showValidOnly&&!t.showInvalidOnly),e.R7$(),e.SpI(" All (",t.uploadResult.totalRows||0,") "),e.R7$(),e.AVh("active",t.showValidOnly),e.R7$(),e.SpI(" Valid (",t.uploadResult.validRows||0,") "),e.R7$(),e.AVh("active",t.showInvalidOnly),e.R7$(),e.SpI(" Invalid (",t.uploadResult.invalidRows||0,") "),e.R7$(4),e.R50("ngModel",t.searchQuery),e.R7$(32),e.Y8G("ngForOf",t.getPaginatedLoans()),e.R7$(),e.Y8G("ngIf",t.getTotalPages()>1),e.R7$(10),e.Y8G("disabled",!t.uploadResult||0===t.uploadResult.validRows),e.R7$(3),e.SpI(" Import ",t.uploadResult.validRows||0," Valid Loans ")}}function I(a,r){if(1&a&&(e.j41(0,"div",41)(1,"div",42),e.nrm(2,"div",43),e.k0s(),e.j41(3,"div",44),e.EFF(4),e.k0s()()),2&a){const t=e.XpG(2);e.R7$(2),e.xc7("width",t.importProgress,"%"),e.R7$(2),e.SpI("",t.importProgress,"%")}}function L(a,r){1&a&&e.nrm(0,"div",40)}function S(a,r){if(1&a&&(e.j41(0,"div",68)(1,"div",37),e.DNE(2,I,5,3,"div",39)(3,L,1,0,"div",38),e.j41(4,"h2"),e.EFF(5,"Importing Loans..."),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s()()()),2&a){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",t.importing),e.R7$(),e.Y8G("ngIf",!t.importing),e.R7$(4),e.SpI("Please wait while we import ",t.uploadResult.validRows||0," loans into the system")}}function T(a,r){1&a&&(e.j41(0,"p"),e.EFF(1,"All loans have been successfully imported into the system."),e.k0s())}function N(a,r){1&a&&(e.j41(0,"p"),e.EFF(1,"Some loans could not be imported. Please review the errors below."),e.k0s())}function V(a,r){if(1&a&&(e.j41(0,"div",80)(1,"i",3),e.EFF(2,"error"),e.k0s(),e.j41(3,"div")(4,"h3"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7,"Failed"),e.k0s()()()),2&a){const t=e.XpG(2);e.R7$(5),e.JRh(t.importResult.failureCount)}}function B(a,r){if(1&a&&(e.j41(0,"div",84)(1,"div",85)(2,"strong"),e.EFF(3),e.k0s(),e.EFF(4),e.k0s(),e.j41(5,"div",86),e.EFF(6),e.k0s()()),2&a){const t=r.$implicit;e.R7$(3),e.SpI("Row ",null==t?null:t.rowNumber,":"),e.R7$(),e.Lme(" ",null==t?null:t.customerName," (",null==t?null:t.customerId,") "),e.R7$(2),e.JRh(null==t?null:t.errorMessage)}}function $(a,r){if(1&a&&(e.j41(0,"div",81)(1,"h3"),e.EFF(2,"Failed Imports"),e.k0s(),e.j41(3,"div",82),e.DNE(4,B,7,4,"div",83),e.k0s()()),2&a){const t=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",t.importResult.failedImports)}}function z(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",69)(1,"div",70)(2,"div",71)(3,"i",3),e.EFF(4),e.k0s()(),e.j41(5,"h2"),e.EFF(6),e.k0s(),e.DNE(7,T,2,0,"p",72)(8,N,2,0,"p",72),e.j41(9,"div",73)(10,"div",74)(11,"i",3),e.EFF(12,"check_circle"),e.k0s(),e.j41(13,"div")(14,"h3"),e.EFF(15),e.k0s(),e.j41(16,"p"),e.EFF(17,"Successfully Imported"),e.k0s()()(),e.DNE(18,V,8,1,"div",75),e.j41(19,"div",76)(20,"i",3),e.EFF(21,"percent"),e.k0s(),e.j41(22,"div")(23,"h3"),e.EFF(24),e.k0s(),e.j41(25,"p"),e.EFF(26,"Success Rate"),e.k0s()()()(),e.DNE(27,$,5,1,"div",77),e.j41(28,"div",78)(29,"button",35),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.reset())}),e.j41(30,"i",3),e.EFF(31,"upload"),e.k0s(),e.EFF(32," Upload Another File "),e.k0s(),e.j41(33,"button",79)(34,"i",3),e.EFF(35,"arrow_forward"),e.k0s(),e.EFF(36," View Clients "),e.k0s()()()()}if(2&a){const t=e.XpG();e.R7$(2),e.AVh("success",0===t.importResult.failureCount)("warning",(t.importResult.failureCount||0)>0),e.R7$(2),e.JRh(0===t.importResult.failureCount?"check_circle":"warning"),e.R7$(2),e.SpI("Import ",0===t.importResult.failureCount?"Complete!":"Completed with Errors",""),e.R7$(),e.Y8G("ngIf",0===t.importResult.failureCount),e.R7$(),e.Y8G("ngIf",(t.importResult.failureCount||0)>0),e.R7$(7),e.JRh(t.importResult.successCount),e.R7$(3),e.Y8G("ngIf",(t.importResult.failureCount||0)>0),e.R7$(6),e.SpI("",t.getSuccessPercentage(),"%"),e.R7$(3),e.Y8G("ngIf",(t.importResult.failureCount||0)>0)}}let D=(()=>{class a{loanBookService;constructor(t){this.loanBookService=t}currentStep="upload";selectedFile=null;errorMessage="";allLoans=[];validLoans=[];invalidLoans=[];showValidOnly=!1;showInvalidOnly=!1;searchQuery="";currentPage=1;itemsPerPage=10;uploadProgress=0;uploading=!1;importProgress=0;importing=!1;successCount=0;failureCount=0;failedImports=[];downloadTemplate(){console.log("Generating loan book template...");const o=["Customer ID*","Customer Name*","Phone Number*","Email","Product Code*","Product Name","Principal Amount*","Interest Rate*","Term (months)*","Disbursement Date*","Status*","Outstanding Balance","Total Paid","Payments Made","Last Payment Date","Collateral Type","Collateral Value","Guarantor Name","Guarantor Phone","Loan Purpose","Branch Code","Loan Officer"],s=[Array(o.length).fill(""),Array(o.length).fill(""),Array(o.length).fill(""),Array(o.length).fill("")],u=["=== LOAN BOOK UPLOAD TEMPLATE ===","","IMPORTANT INSTRUCTIONS:","1. DO NOT open this file in Excel - use Google Sheets or LibreOffice Calc instead",'2. If you must use Excel: Format the "Phone Number" and "Guarantor Phone" columns as TEXT before entering data',"3. Phone format: 254XXXXXXXXX (12 digits) or 07XXXXXXXX (10 digits)","4. Date format: YYYY-MM-DD (e.g., 2024-01-15)","5. Required fields marked with (*)","6. Customer IDs and Product Codes must exist in the system","","DELETE THESE INSTRUCTION ROWS BEFORE UPLOADING","-----------------------------------","",o.join(","),["CUST001","John Doe","'254712345678","john.doe@example.com","LOAN001","Personal Loan","50000","12.5","12","2024-01-15","ACTIVE","45000","5000","2","2024-02-15","Vehicle","750000","Jane Doe","'254787654321","Business Expansion","BR001","Peter Smith"].join(","),...s.map(f=>f.join(","))].join("\n"),g=new Blob([u],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),i=URL.createObjectURL(g);l.setAttribute("href",i),l.setAttribute("download","loan_book_upload_template.csv"),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i),console.log("Template downloaded successfully")}onFileDrop(t){t.preventDefault(),t.stopPropagation();const o=t.dataTransfer?.files;o&&o.length>0&&this.validateFile(o[0])}onDragOver(t){t.preventDefault(),t.stopPropagation()}onFileSelected(t){const o=t.target.files[0];o&&this.validateFile(o)}validateFile(t){if(this.errorMessage="",t)return["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv","application/csv"].includes(t.type)||t.name.toLowerCase().endsWith(".xlsx")||t.name.toLowerCase().endsWith(".xls")||t.name.toLowerCase().endsWith(".csv")?t.size>10485760?(this.errorMessage="File too large. Maximum size is 10MB",void(this.selectedFile=null)):0===t.size?(this.errorMessage="File is empty. Please select a valid file",void(this.selectedFile=null)):(this.selectedFile=t,void console.log("File validated successfully:",t.name,"Size:",t.size,"bytes","Type:",t.type)):(this.errorMessage="Invalid file type. Please upload an Excel file (.xlsx, .xls) or CSV file (.csv)",void(this.selectedFile=null));this.errorMessage="No file selected"}uploadFile(){if(!this.selectedFile)return;this.currentStep="validate",this.errorMessage="",this.uploading=!0,this.uploadProgress=0;const t=setInterval(()=>{this.uploadProgress<90&&(this.uploadProgress+=10)},200);this.loanBookService.uploadFile(this.selectedFile).subscribe({next:o=>{clearInterval(t),this.uploadProgress=100,this.uploading=!1,console.log("Upload successful:",o),this.validLoans=o.validLoans.map(n=>this.convertDTOToLoanData(n)),this.invalidLoans=o.invalidLoans.map(n=>this.convertDTOToLoanData(n)),this.allLoans=[...this.validLoans,...this.invalidLoans],this.currentStep="preview"},error:o=>{clearInterval(t),this.uploading=!1,this.uploadProgress=0,console.error("Upload error:",o),this.errorMessage=405===o.status?"API endpoint not found (405 Method Not Allowed). Please ensure the backend server is running and the loan-book endpoints are properly configured.":404===o.status?"Loan book upload endpoint not found. Please check if the backend API is running on port 8082.":0===o.status?"Cannot connect to backend server. Please ensure the backend is running on localhost:8082.":o.error?.error||o.message||"Error uploading file. Please try again.",this.currentStep="upload"}})}convertDTOToLoanData(t){return{rowNumber:t.rowNumber||0,customerId:t.customerId||"",customerName:t.customerName||"",phoneNumber:t.phoneNumber||"",email:t.email,productCode:t.productCode||"",productName:t.productName,principal:t.principal||0,interestRate:t.interestRate||0,term:t.term||0,disbursementDate:t.disbursementDate,status:t.status||"",outstandingBalance:t.outstandingBalance,totalPaid:t.totalPaid,paymentsMade:t.paymentsMade,lastPaymentDate:t.lastPaymentDate,collateralType:t.collateralType,collateralValue:t.collateralValue,guarantorName:t.guarantorName,guarantorPhone:t.guarantorPhone,loanPurpose:t.loanPurpose,branchCode:t.branchCode,loanOfficer:t.loanOfficer,isValid:t.isValid||!1,errorMessage:t.errorMessage}}importLoans(){if(0===this.validLoans.length)return void(this.errorMessage="No valid loans to import");this.currentStep="import",this.importing=!0,this.importProgress=0;const t=this.validLoans.map(n=>({rowNumber:n.rowNumber,customerId:n.customerId,customerName:n.customerName,phoneNumber:n.phoneNumber,email:n.email,productCode:n.productCode,productName:n.productName,principal:n.principal,interestRate:n.interestRate,term:n.term,disbursementDate:n.disbursementDate,status:n.status,outstandingBalance:n.outstandingBalance,totalPaid:n.totalPaid,paymentsMade:n.paymentsMade,lastPaymentDate:n.lastPaymentDate,collateralType:n.collateralType,collateralValue:n.collateralValue,guarantorName:n.guarantorName,guarantorPhone:n.guarantorPhone,loanPurpose:n.loanPurpose,branchCode:n.branchCode,loanOfficer:n.loanOfficer,isValid:n.isValid,errorMessage:n.errorMessage})),o=setInterval(()=>{this.importProgress<90&&(this.importProgress+=10)},200);this.loanBookService.importLoans(t).subscribe({next:n=>{clearInterval(o),this.importProgress=100,this.importing=!1,console.log("Import successful:",n),this.successCount=n.successCount,this.failureCount=n.failureCount,this.failedImports=n.failedImports.map(s=>this.convertDTOToLoanData(s)),this.currentStep="complete"},error:n=>{clearInterval(o),this.importing=!1,this.importProgress=0,console.error("Import error:",n),this.errorMessage=n.message||"Error importing loans. Please try again.",this.currentStep="preview"}})}reset(){this.currentStep="upload",this.selectedFile=null,this.errorMessage="",this.allLoans=[],this.validLoans=[],this.invalidLoans=[],this.showValidOnly=!1,this.showInvalidOnly=!1,this.searchQuery="",this.currentPage=1,this.uploadProgress=0,this.uploading=!1,this.importProgress=0,this.importing=!1,this.successCount=0,this.failureCount=0,this.failedImports=[]}getFilteredLoans(){let t=[];if(t=this.showValidOnly?this.validLoans:this.showInvalidOnly?this.invalidLoans:this.allLoans,this.searchQuery){const o=this.searchQuery.toLowerCase();t=t.filter(n=>n.customerId.toLowerCase().includes(o)||n.customerName.toLowerCase().includes(o)||n.phoneNumber.includes(o)||n.productCode.toLowerCase().includes(o))}return t}getPaginatedLoans(){const t=this.getFilteredLoans(),o=(this.currentPage-1)*this.itemsPerPage;return t.slice(o,o+this.itemsPerPage)}getTotalPages(){const t=this.getFilteredLoans();return Math.ceil(t.length/this.itemsPerPage)}exportResults(){const t=this.getFilteredLoans().map(o=>({rowNumber:o.rowNumber,customerId:o.customerId,customerName:o.customerName,phoneNumber:o.phoneNumber,email:o.email,productCode:o.productCode,productName:o.productName,principal:o.principal,interestRate:o.interestRate,term:o.term,disbursementDate:o.disbursementDate,status:o.status,outstandingBalance:o.outstandingBalance,totalPaid:o.totalPaid,paymentsMade:o.paymentsMade,lastPaymentDate:o.lastPaymentDate,isValid:o.isValid,errorMessage:o.errorMessage}));this.loanBookService.exportToCSV(t,"loan_book_results")}get uploadResult(){return 0===this.allLoans.length?null:{totalRows:this.allLoans.length,validRows:this.validLoans.length,invalidRows:this.invalidLoans.length,validLoans:this.validLoans,invalidLoans:this.invalidLoans}}changePage(t){t>=1&&t<=this.getTotalPages()&&(this.currentPage=t)}getFileSizeMB(){return this.selectedFile?(this.selectedFile.size/1048576).toFixed(2)+" MB":""}formatCurrency(t){return"KES "+t.toLocaleString()}getValidationColor(t){return t?"success":"danger"}getValidationIcon(t){return t?"check_circle":"error"}getStatusColor(t){switch(t.toLowerCase()){case"active":return"success";case"pending":return"warning";default:return"secondary"}}get importResult(){return"complete"!==this.currentStep?null:{successCount:this.successCount,failureCount:this.failureCount,failedImports:this.failedImports}}getSuccessPercentage(){const t=this.successCount+this.failureCount;return 0===t?0:Math.round(this.successCount/t*100)}static \u0275fac=function(o){return new(o||a)(e.rXU(b))};static \u0275cmp=e.VBU({type:a,selectors:[["app-loan-book-upload"]],standalone:!0,features:[e.Jv_([b]),e.aNF],decls:55,vars:32,consts:[[1,"upload-container"],[1,"page-header"],[1,"header-content"],[1,"material-icons"],[1,"subtitle"],[1,"header-actions"],[1,"btn","btn-primary",3,"click"],[1,"progress-steps"],[1,"step"],[1,"step-icon"],[1,"step-label"],[1,"step-connector"],["class","alert alert-error",4,"ngIf"],["class","upload-step",4,"ngIf"],["class","validate-step",4,"ngIf"],["class","preview-step",4,"ngIf"],["class","import-step",4,"ngIf"],["class","complete-step",4,"ngIf"],[1,"alert","alert-error"],[1,"upload-step"],[1,"upload-card"],[1,"upload-area",3,"drop","dragover"],["class","upload-prompt",4,"ngIf"],["class","file-selected",4,"ngIf"],["class","upload-actions",4,"ngIf"],[1,"instructions-card"],[1,"upload-prompt"],["for","fileInput",1,"btn","btn-primary"],["type","file","id","fileInput","accept",".xlsx,.xls,.csv",2,"display","none",3,"change"],[1,"file-requirements"],[1,"file-selected"],[1,"material-icons","file-icon"],[1,"file-info"],[1,"btn-remove",3,"click"],[1,"upload-actions"],[1,"btn","btn-secondary",3,"click"],[1,"validate-step"],[1,"processing-card"],["class","spinner-large",4,"ngIf"],["class","progress-container",4,"ngIf"],[1,"spinner-large"],[1,"progress-container"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"preview-step"],[1,"results-summary"],[1,"summary-card","total"],[1,"summary-content"],[1,"summary-card","valid"],[1,"summary-card","invalid"],[1,"table-controls"],[1,"filters"],[1,"filter-btn",3,"click"],[1,"search-box"],["type","text","placeholder","Search by customer, phone, or product...",3,"ngModelChange","input","ngModel"],[1,"btn","btn-outline",3,"click"],[1,"table-container"],[1,"results-table"],[3,"valid-row","invalid-row",4,"ngFor","ngForOf"],["class","pagination",4,"ngIf"],[1,"preview-actions"],[1,"btn","btn-primary",3,"click","disabled"],[1,"status-badge"],[1,"error-cell"],[1,"pagination"],[1,"page-btn",3,"click","disabled"],[1,"page-info"],[1,"import-step"],[1,"complete-step"],[1,"completion-card"],[1,"completion-icon"],[4,"ngIf"],[1,"import-stats"],[1,"stat-card","success"],["class","stat-card error",4,"ngIf"],[1,"stat-card"],["class","failed-imports",4,"ngIf"],[1,"completion-actions"],["routerLink","/admin/clients",1,"btn","btn-primary"],[1,"stat-card","error"],[1,"failed-imports"],[1,"failed-list"],["class","failed-item",4,"ngFor","ngForOf"],[1,"failed-item"],[1,"failed-info"],[1,"failed-error"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1")(4,"i",3),e.EFF(5,"upload_file"),e.k0s(),e.EFF(6," Loan Book Upload "),e.k0s(),e.j41(7,"p",4),e.EFF(8,"Import existing loans from Excel/CSV spreadsheet"),e.k0s()(),e.j41(9,"div",5)(10,"button",6),e.bIt("click",function(){return n.downloadTemplate()}),e.j41(11,"i",3),e.EFF(12,"download"),e.k0s(),e.EFF(13," Download Template "),e.k0s()()(),e.j41(14,"div",7)(15,"div",8)(16,"div",9)(17,"i",3),e.EFF(18,"cloud_upload"),e.k0s()(),e.j41(19,"div",10),e.EFF(20,"Upload File"),e.k0s()(),e.nrm(21,"div",11),e.j41(22,"div",8)(23,"div",9)(24,"i",3),e.EFF(25,"fact_check"),e.k0s()(),e.j41(26,"div",10),e.EFF(27,"Validate"),e.k0s()(),e.nrm(28,"div",11),e.j41(29,"div",8)(30,"div",9)(31,"i",3),e.EFF(32,"preview"),e.k0s()(),e.j41(33,"div",10),e.EFF(34,"Preview"),e.k0s()(),e.nrm(35,"div",11),e.j41(36,"div",8)(37,"div",9)(38,"i",3),e.EFF(39,"import_export"),e.k0s()(),e.j41(40,"div",10),e.EFF(41,"Import"),e.k0s()(),e.nrm(42,"div",11),e.j41(43,"div",8)(44,"div",9)(45,"i",3),e.EFF(46,"check_circle"),e.k0s()(),e.j41(47,"div",10),e.EFF(48,"Complete"),e.k0s()()(),e.DNE(49,v,5,1,"div",12)(50,O,24,5,"div",13)(51,y,8,4,"div",14)(52,E,84,17,"div",15)(53,S,8,3,"div",16)(54,z,37,12,"div",17),e.k0s()),2&o&&(e.R7$(15),e.AVh("active","upload"===n.currentStep)("completed","upload"!==n.currentStep),e.R7$(6),e.AVh("completed","upload"!==n.currentStep),e.R7$(),e.AVh("active","validate"===n.currentStep)("completed","preview"===n.currentStep||"import"===n.currentStep||"complete"===n.currentStep),e.R7$(6),e.AVh("completed","preview"===n.currentStep||"import"===n.currentStep||"complete"===n.currentStep),e.R7$(),e.AVh("active","preview"===n.currentStep)("completed","import"===n.currentStep||"complete"===n.currentStep),e.R7$(6),e.AVh("completed","import"===n.currentStep||"complete"===n.currentStep),e.R7$(),e.AVh("active","import"===n.currentStep)("completed","complete"===n.currentStep),e.R7$(6),e.AVh("completed","complete"===n.currentStep),e.R7$(),e.AVh("active","complete"===n.currentStep),e.R7$(6),e.Y8G("ngIf",n.errorMessage),e.R7$(),e.Y8G("ngIf","upload"===n.currentStep),e.R7$(),e.Y8G("ngIf","validate"===n.currentStep),e.R7$(),e.Y8G("ngIf","preview"===n.currentStep&&n.uploadResult),e.R7$(),e.Y8G("ngIf","import"===n.currentStep),e.R7$(),e.Y8G("ngIf","complete"===n.currentStep&&n.importResult))},dependencies:[d.YN,d.me,d.BC,d.vS,d.X1,p.MD,p.Sq,p.bT,_.iI,_.Wk],styles:['.upload-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:40px;background:linear-gradient(135deg,#f5f7fa,#e8ecf1);min-height:calc(100vh - 200px);position:relative}.upload-container[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:300px;background:linear-gradient(135deg,#667eea,#764ba2);opacity:.05;border-radius:0 0 50% 50%;z-index:0;pointer-events:none}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:40px;background:#fffffff2;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);padding:35px 40px;border-radius:20px;box-shadow:0 10px 40px #0000001a;border:1px solid rgba(255,255,255,.8);position:relative;z-index:1;overflow:hidden}.page-header[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;right:0;width:200px;height:200px;background:linear-gradient(135deg,#667eea,#764ba2);opacity:.1;border-radius:50%;transform:translate(50%,-50%)}.header-content[_ngcontent-%COMP%]{position:relative;z-index:2}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin:0 0 10px;font-size:32px;font-weight:800;background:linear-gradient(135deg,#2c3e50,#667eea);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:40px;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:_ngcontent-%COMP%_float 3s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}.subtitle[_ngcontent-%COMP%]{color:#6c757d;margin:0;font-size:16px;font-weight:500}.header-actions[_ngcontent-%COMP%]{position:relative;z-index:2}.header-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px;position:relative;overflow:hidden}.header-actions[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);border:none;color:#fff;padding:14px 32px;font-size:15px;font-weight:700;box-shadow:0 6px 25px #10b98166;transition:all .4s cubic-bezier(.175,.885,.32,1.275)}.header-actions[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:left .5s}.header-actions[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover:before{left:100%}.header-actions[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 10px 35px #10b98180}.header-actions[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:22px;animation:_ngcontent-%COMP%_bounce 2s infinite}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-8px)}60%{transform:translateY(-4px)}}.progress-steps[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:45px;background:#fffffffa;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:35px 45px;border-radius:20px;box-shadow:0 10px 40px #00000014;border:1px solid rgba(255,255,255,.8);position:relative;z-index:1}.step[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;position:relative;flex:0 0 auto}.step-icon[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:50%;background:linear-gradient(135deg,#f8f9fa,#e9ecef);display:flex;align-items:center;justify-content:center;transition:all .5s cubic-bezier(.175,.885,.32,1.275);border:4px solid #e9ecef;position:relative;z-index:2}.step-icon[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-4px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);opacity:0;transition:opacity .3s ease;z-index:-1}.step-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:32px;color:#a0aec0;transition:all .3s ease}.step.active[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-color:#667eea;box-shadow:0 8px 30px #667eea80;transform:scale(1.15)}.step.active[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]:before{opacity:.3;animation:_ngcontent-%COMP%_pulse-ring 2s infinite}@keyframes _ngcontent-%COMP%_pulse-ring{0%{transform:scale(1);opacity:.3}50%{transform:scale(1.2);opacity:.1}to{transform:scale(1);opacity:.3}}.step.active[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;animation:_ngcontent-%COMP%_icon-bounce 1s ease}@keyframes _ngcontent-%COMP%_icon-bounce{0%,to{transform:scale(1)}50%{transform:scale(1.2)}}.step.completed[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);border-color:#10b981;box-shadow:0 6px 20px #10b98166}.step.completed[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.step-label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#a0aec0;text-align:center;transition:all .3s ease;letter-spacing:.3px}.step.active[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{color:#667eea;font-size:15px}.step.completed[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{color:#10b981}.step-connector[_ngcontent-%COMP%]{height:4px;background:linear-gradient(90deg,#e9ecef,#dee2e6);flex:1;margin:0 20px;transition:all .5s ease;position:relative;border-radius:10px;overflow:hidden}.step-connector[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;height:100%;width:0;background:linear-gradient(90deg,#10b981,#059669);transition:width .5s ease;border-radius:10px}.step-connector.completed[_ngcontent-%COMP%]:before{width:100%}.upload-card[_ngcontent-%COMP%]{background:#fffffffa;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:20px;padding:45px;box-shadow:0 10px 40px #00000014;border:1px solid rgba(255,255,255,.8);position:relative;z-index:1}.upload-area[_ngcontent-%COMP%]{border:4px dashed #cbd5e0;border-radius:24px;padding:80px 50px;text-align:center;background:linear-gradient(135deg,#f8f9fa,#fff);transition:all .4s cubic-bezier(.175,.885,.32,1.275);cursor:pointer;position:relative;overflow:hidden}.upload-area[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:radial-gradient(circle,rgba(102,126,234,.1) 0%,transparent 70%);transform:translate(-50%,-50%);transition:all .5s ease}.upload-area[_ngcontent-%COMP%]:hover:before{width:500px;height:500px}.upload-area[_ngcontent-%COMP%]:hover{border-color:#667eea;background:linear-gradient(135deg,#f8f9ff,#faf8ff);transform:scale(1.02);box-shadow:0 10px 40px #667eea26}.upload-area.has-file[_ngcontent-%COMP%]{border-style:solid;border-color:#10b981;border-width:4px;background:linear-gradient(135deg,#ecfdf5,#f0fdf4);box-shadow:0 10px 40px #10b98126}.upload-prompt[_ngcontent-%COMP%]{position:relative;z-index:1}.upload-prompt[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:100px;background:linear-gradient(135deg,#cbd5e0,#a0aec0);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:25px;animation:_ngcontent-%COMP%_pulse-icon 3s ease-in-out infinite}@keyframes _ngcontent-%COMP%_pulse-icon{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.upload-prompt[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 15px;color:#2c3e50;font-size:24px;font-weight:700;letter-spacing:-.5px}.upload-prompt[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;margin:15px 0;font-size:16px;font-weight:500}.file-requirements[_ngcontent-%COMP%]{font-size:14px;color:#a0aec0;margin-top:20px;padding:10px 20px;background:#fffc;border-radius:20px;display:inline-block}.file-selected[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;padding:20px}.file-icon[_ngcontent-%COMP%]{font-size:48px;color:#667eea}.file-info[_ngcontent-%COMP%]{flex:1;text-align:left}.file-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 5px;color:#2c3e50;font-size:18px;font-weight:600}.file-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6c757d;font-size:14px}.btn-remove[_ngcontent-%COMP%]{background:#fee;border:none;width:40px;height:40px;border-radius:50%;cursor:pointer;transition:all .3s ease}.btn-remove[_ngcontent-%COMP%]:hover{background:#fcc}.btn-remove[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#dc3545}.upload-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:15px;margin-top:30px}.instructions-card[_ngcontent-%COMP%]{margin-top:35px;padding:35px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:20px;box-shadow:0 10px 40px #667eea4d;position:relative;overflow:hidden}.instructions-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;right:-50%;width:200px;height:200px;background:#ffffff1a;border-radius:50%}.instructions-card[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-30%;left:-20%;width:150px;height:150px;background:#ffffff14;border-radius:50%}.instructions-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0 0 25px;color:#fff;font-size:22px;font-weight:700;position:relative;z-index:1}.instructions-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:28px;background:#fff3;padding:8px;border-radius:12px}.instructions-card[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:0;padding-left:25px;position:relative;z-index:1}.instructions-card[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:15px 0;color:#fffffff2;line-height:1.8;font-size:15px;font-weight:500;padding-left:10px}.instructions-card[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker{color:#ffffffe6;font-weight:700}.processing-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:80px 40px;text-align:center;box-shadow:0 2px 12px #00000014}.spinner-large[_ngcontent-%COMP%]{width:80px;height:80px;border:6px solid #e9ecef;border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 30px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.processing-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 10px;color:#2c3e50;font-size:24px}.processing-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;margin:0}.results-summary[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}.summary-card[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:16px;box-shadow:0 2px 12px #00000014;display:flex;align-items:center;gap:20px;transition:all .3s ease}.summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 6px 20px #0000001f}.summary-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px}.summary-card.total[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea}.summary-card.valid[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#10b981}.summary-card.invalid[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#dc3545}.summary-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 5px;font-size:32px;font-weight:700;color:#2c3e50}.summary-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6c757d;font-size:14px}.table-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:20px;flex-wrap:wrap}.filters[_ngcontent-%COMP%]{display:flex;gap:10px}.filter-btn[_ngcontent-%COMP%]{padding:10px 20px;border:2px solid #e9ecef;background:#fff;border-radius:10px;cursor:pointer;transition:all .3s ease;font-weight:600;color:#6c757d}.filter-btn[_ngcontent-%COMP%]:hover{border-color:#667eea;color:#667eea}.filter-btn.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-color:#667eea;color:#fff}.search-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;flex:1;background:#fff;padding:10px 15px;border-radius:10px;border:2px solid #e9ecef}.search-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#6c757d}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;outline:none;font-size:14px}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 2px 12px #00000014;margin-bottom:20px}.results-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.results-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef)}.results-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:18px 16px;text-align:left;font-weight:700;color:#2c3e50;font-size:13px;text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid #667eea}.results-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid #e9ecef;color:#2c3e50;font-size:14px}.results-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .2s ease}.results-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8f9fa}.results-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.valid-row[_ngcontent-%COMP%]{background:#10b9810d}.results-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.invalid-row[_ngcontent-%COMP%]{background:#dc35450d}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;white-space:nowrap}.status-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.status-badge.success[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.status-badge.danger[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.status-badge.warning[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-badge.secondary[_ngcontent-%COMP%]{background:#e9ecef;color:#6c757d}.error-cell[_ngcontent-%COMP%]{color:#dc3545;font-size:13px;max-width:300px}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:20px;padding:20px;background:#fff;border-radius:12px;box-shadow:0 2px 12px #00000014;margin-bottom:20px}.page-btn[_ngcontent-%COMP%]{background:#fff;border:2px solid #e9ecef;width:40px;height:40px;border-radius:10px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center}.page-btn[_ngcontent-%COMP%]:hover:not(:disabled){border-color:#667eea;background:#f8f9ff}.page-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.page-info[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600}.preview-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:15px}.completion-card[_ngcontent-%COMP%]{background:#fffffffa;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:24px;padding:70px 50px;text-align:center;box-shadow:0 15px 50px #0000001a;border:1px solid rgba(255,255,255,.8);position:relative;overflow:hidden}.completion-card[_ngcontent-%COMP%]:before{content:"\\1f389";position:absolute;top:-20px;right:-20px;font-size:120px;opacity:.1;animation:_ngcontent-%COMP%_rotate-emoji 20s linear infinite}.completion-card[_ngcontent-%COMP%]:after{content:"\\2728";position:absolute;bottom:-20px;left:-20px;font-size:100px;opacity:.1;animation:_ngcontent-%COMP%_rotate-emoji 15s linear infinite reverse}@keyframes _ngcontent-%COMP%_rotate-emoji{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.completion-icon[_ngcontent-%COMP%]{width:140px;height:140px;border-radius:50%;margin:0 auto 35px;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_bounceIn .8s cubic-bezier(.68,-.55,.265,1.55);position:relative;z-index:1}@keyframes _ngcontent-%COMP%_bounceIn{0%{transform:scale(0) rotate(-180deg);opacity:0}50%{transform:scale(1.2) rotate(10deg)}to{transform:scale(1) rotate(0);opacity:1}}.completion-icon.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);box-shadow:0 15px 50px #10b98180;animation:_ngcontent-%COMP%_bounceIn .8s cubic-bezier(.68,-.55,.265,1.55),_ngcontent-%COMP%_glow-success 2s ease-in-out infinite}.completion-icon.warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706);box-shadow:0 15px 50px #f59e0b80;animation:_ngcontent-%COMP%_bounceIn .8s cubic-bezier(.68,-.55,.265,1.55),_ngcontent-%COMP%_glow-warning 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_glow-success{0%,to{box-shadow:0 15px 50px #10b98180}50%{box-shadow:0 20px 60px #10b981b3}}@keyframes _ngcontent-%COMP%_glow-warning{0%,to{box-shadow:0 15px 50px #f59e0b80}50%{box-shadow:0 20px 60px #f59e0bb3}}.completion-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:72px;color:#fff;animation:_ngcontent-%COMP%_icon-pop 1.2s ease}@keyframes _ngcontent-%COMP%_icon-pop{0%,to{transform:scale(1)}50%{transform:scale(1.3)}}.completion-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 20px;color:#2c3e50;font-size:36px;font-weight:800;letter-spacing:-.5px;position:relative;z-index:1}.completion-card[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{color:#6c757d;margin:0 0 50px;font-size:18px;font-weight:500;line-height:1.6;position:relative;z-index:1}.import-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:40px}.stat-card[_ngcontent-%COMP%]{background:#f8f9fa;padding:25px;border-radius:12px;display:flex;align-items:center;gap:15px}.stat-card.success[_ngcontent-%COMP%]{background:#d1fae5}.stat-card.error[_ngcontent-%COMP%]{background:#fee2e2}.stat-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:40px}.stat-card.success[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#10b981}.stat-card.error[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#dc3545}.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 5px;font-size:28px;font-weight:700;color:#2c3e50}.stat-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#6c757d}.failed-imports[_ngcontent-%COMP%]{background:#fff5f5;border:2px solid #fecaca;border-radius:12px;padding:25px;margin-bottom:30px;text-align:left}.failed-imports[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;color:#991b1b;font-size:18px}.failed-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.failed-item[_ngcontent-%COMP%]{padding:15px;background:#fff;border-radius:8px;margin-bottom:10px}.failed-info[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600;margin-bottom:5px}.failed-error[_ngcontent-%COMP%]{color:#dc3545;font-size:13px}.completion-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px}.alert[_ngcontent-%COMP%]{padding:15px 20px;border-radius:12px;display:flex;align-items:center;gap:12px;margin-bottom:20px}.alert-error[_ngcontent-%COMP%]{background:#fee2e2;border:2px solid #fecaca;color:#991b1b}.alert[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}.btn[_ngcontent-%COMP%]{padding:14px 32px;border-radius:12px;font-size:15px;font-weight:700;border:none;cursor:pointer;transition:all .4s cubic-bezier(.175,.885,.32,1.275);display:inline-flex;align-items:center;gap:10px;position:relative;overflow:hidden;letter-spacing:.3px}.btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:#ffffff4d;transform:translate(-50%,-50%);transition:width .6s,height .6s}.btn[_ngcontent-%COMP%]:hover:before{width:300px;height:300px}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:22px;position:relative;z-index:1}.btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:relative;z-index:1}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 6px 25px #667eea66}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-3px) scale(1.03);box-shadow:0 12px 35px #667eea80}.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(-1px) scale(1.01)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}.btn-secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e9ecef,#dee2e6);color:#495057;box-shadow:0 4px 15px #00000014}.btn-secondary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#dee2e6,#cbd3da);transform:translateY(-2px);box-shadow:0 6px 20px #0000001f}.btn-outline[_ngcontent-%COMP%]{background:#fff;border:2px solid #667eea;color:#667eea;box-shadow:0 4px 15px #667eea26}.btn-outline[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-color:transparent;transform:translateY(-2px) scale(1.03);box-shadow:0 8px 25px #667eea66}.upload-prompt[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{padding:16px 40px;font-size:16px;margin:20px 0;border-radius:50px;background:linear-gradient(135deg,#667eea,#764ba2);box-shadow:0 8px 30px #667eea66}.upload-prompt[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-4px) scale(1.08);box-shadow:0 15px 40px #667eea80}@media (max-width: 768px){.upload-container[_ngcontent-%COMP%]{padding:15px}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:20px;text-align:center}.progress-steps[_ngcontent-%COMP%]{padding:20px;overflow-x:auto}.step[_ngcontent-%COMP%]{flex-shrink:0}.table-controls[_ngcontent-%COMP%]{flex-direction:column}.filters[_ngcontent-%COMP%], .search-box[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.results-table[_ngcontent-%COMP%]{min-width:1000px}.completion-actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}']})}return a})()}}]);